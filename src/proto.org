* PROTOCAL

|                    | rssi | ber | zone | timestamp | board | lock | states | cmd-type | chargers | locks | pins | temperature | card-no | card-reader | audio | reply-time | ttl | gprs-reset | gprs-shutdown |
|--------------------+------+-----+------+-----------+-------+------+--------+----------+----------+-------+------+-------------+---------+-------------+-------+------------+-----+------------+---------------|
| PING               | ✓    | ✓   |      |           |       |      |        |          | ✓        |       |      | ✓           |         |             |       | ✓          | ✓   | ✓          | ✓             |
| PONG               |      |     | ✓    | ✓         |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| CONFIRM            |      |     |      |           | [✓]   | [✓]  | [✓]    | ✓        |          | [✓]   |      |             | [✓]     | [✓]         |       |            |     |            |               |
| LOCK_OFF           |      |     |      |           | [✓]   | ✓    |        |          |          |       |      |             | [✓]     | [✓]         |       |            |     |            |               |
| LOCKS_OFF          |      |     |      |           | ✓     |      |        |          |          | ✓     | ✓    |             |         |             |       |            |     |            |               |
| LOCK_STATUS        |      |     |      |           | ✓     | [✓]  |        |          |          |       |      |             |         |             |       |            |     |            |               |
| LOCK_DETECT        |      |     |      |           | ✓     |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| LOCK_STATUS_DETECT |      |     |      |           | ✓     |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| LOCK_DATA          |      |     |      |           | ✓     |      | ✓      |          |          | ✓     |      |             |         |             |       |            |     |            |               |
| LIGHT_ON           |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| LIGHT_OFF          |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| FAN_ON             |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| FAN_OFF            |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| ULTRAVIOLET_ON     |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| ULTRAVIOLET_OFF    |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| CAMERA_ON          |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| CAMERA_OFF         |      |     |      |           |       |      |        |          |          |       |      |             |         |             |       |            |     |            |               |
| CHARGER_STATUS     |      |     |      |           |       |      |        |          | ✓        |       |      |             |         |             |       |            |     |            |               |
| PLAY               |      |     |      |           |       |      |        |          |          |       |      |             |         |             | ✓     |            |     |            |               |

#+begin_src scheme :exports code :noweb yes :mkdirp yes :tangle /dev/shm/box-service/src/proto.scm
  (struct parameter
    (int 0 sn) ;; 请求序列号
    (byte 1 version) ;; 版本号
    (short 2 pin) ;; 命令的 PIN 值
    (byte 3 rssi) ;; 信号强度
    (byte 4 ber) ;; 信号强度相关
    (int 5 zone) ;; 时区
    (long 6 timestamp) ;; 服务端时间戳
    (byte 7 board) ;; 锁控板编号
    (byte 8 lock) ;; 锁编号
    (byte* 9 states) ;; 状态(和锁，测物条相关)
    (byte 10 cmd-type) ;; 确认命令类型
    (byte* 11 chargers) ;; 充电状态
    (byte* 12 locks) ;; 锁编号列表
    (short* 13 pins) ;; 开多个锁时的 PIN 列表
    (short 14 temperature) ;; 芯片温度
    (int 15 card-no) ;; 卡编号
    (byte 16 card-reader) ;; 读卡器编号
    (byte 17 audio) ;; 音频编号
    (short 18 reply-time) ;; PING 响应时间
    (byte 19 ttl) ;; PING TTL
    (int 20 gprs-reset) ;; GPRS RESET 次数
    (int 21 gprs-shutdown) ;; GPRS SHUTDOWN 次数
    )
#+end_src
